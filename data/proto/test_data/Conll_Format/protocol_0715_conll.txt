Taxonomic	O
biomarker	O
discovery	O
with	O
LEfSe	O

Before	O
beginning	O
,	O
we	O
need	O
to	O
convert	O
the	O
sample	O
names	O
into	O
consistent	O
class	O
names	O
.	O

This	O
can	O
easily	O
be	O
done	O
by	O
manually	O
editing	O
the	O
|	O
''	O
blocks	O
''	O
:	O
[	O
|	O
''	O
key	O
''	O
:	O
''	O
630rg	O
''	O
,	O
''	O
text	O
''	O
:	O
''	O
output\/merged_abundance_table.txt	O
''	O
,	O
''	O
type	O
''	O
:	O
''	O
unstyled	O
''	O
,	O
''	O
depth	O
''	O
:0	O
,	O
''	O
inlineStyleRanges	O
''	O
:	O
[	O
]	O
,	O
''	O
entityRanges	O
''	O
:	O
[	O
]	O
,	O
''	O
data	O
''	O
:	O
[	O
]	O
}	O
]	O
,	O
''	O
entityMap	O
''	O
:	O
[	O
]	O
}	O
generated	O
in	O
the	O
previous	O
protocols	O
or	O
using	O
the	O
following	O
``	O
sed	O
''	O
based	O
Unix	O
command	O
:	O
.	O

The	O
first	O
LEfSe	O
step	O
consists	O
of	O
formatting	O
the	O
input	O
table	O
,	O
making	O
sure	O
the	O
class	O
information	O
is	O
in	O
the	O
first	O
row	O
and	O
scaling	O
the	O
values	O
in	O
[	O
0,1M	O
]	O
which	O
is	O
useful	O
for	O
numerical	O
computational	O
reasons	O
.	O

Now	O
,	O
the	O
LEfSe	O
biomarker	O
discovery	O
tool	O
can	O
be	O
used	O
with	O
default	O
statistical	O
options	O
.	O

Here	O
we	O
change	O
one	O
default	O
parameter	O
to	O
increase	O
the	O
threshold	O
on	O
the	O
LDA	O
effect	O
size	O
from	O
2	O
(	O
default	O
)	O
to	O
4	O
.	O

The	O
results	O
of	O
the	O
operation	O
can	O
now	O
be	O
displayed	O
plotting	O
the	O
resulting	O
list	O
of	O
biomarkers	O
with	O
corresponding	O
effect	O
sizes	O
.	O

The	O
resulting	O
image	O
(	O
|	O
''	O
blocks	O
''	O
:	O
[	O
|	O
''	O
key	O
''	O
:	O
''	O
975lt	O
''	O
,	O
''	O
text	O
''	O
:	O
''	O
output_images\/lefse_biomarkers.png	O
''	O
,	O
''	O
type	O
''	O
:	O
''	O
unstyled	O
''	O
,	O
''	O
depth	O
''	O
:0	O
,	O
''	O
inlineStyleRanges	O
''	O
:	O
[	O
]	O
,	O
''	O
entityRanges	O
''	O
:	O
[	O
]	O
,	O
''	O
data	O
''	O
:	O
[	O
]	O
}	O
]	O
,	O
''	O
entityMap	O
''	O
:	O
[	O
]	O
}	O
)	O
is	O
shown	O
below	O
:	O
.	O

Another	O
complementary	O
visualization	O
focuses	O
on	O
showing	O
the	O
biomarkers	O
on	O
the	O
underlying	O
taxonomic	O
tree	O
.	O

The	O
default	O
plotting	O
output	O
is	O
shown	O
here	O
:	O
.	O

Single	O
features	O
can	O
also	O
be	O
plotted	O
as	O
barplots	O
with	O
|	O
''	O
blocks	O
''	O
:	O
[	O
|	O
''	O
key	O
''	O
:	O
''	O
25aim	O
''	O
,	O
''	O
text	O
''	O
:	O
''	O
plot_features.py	O
''	O
,	O
''	O
type	O
''	O
:	O
''	O
unstyled	O
''	O
,	O
''	O
depth	O
''	O
:0	O
,	O
''	O
inlineStyleRanges	O
''	O
:	O
[	O
]	O
,	O
''	O
entityRanges	O
''	O
:	O
[	O
]	O
,	O
''	O
data	O
''	O
:	O
[	O
]	O
}	O
]	O
,	O
''	O
entityMap	O
''	O
:	O
[	O
]	O
}	O
.	O

For	O
example	O
,	O
to	O
plot	O
the	O
distribution	O
of	O
abundances	O
for	O
Firmicutes	O
the	O
command	O
is	O
:	O
.	O

All	O
features	O
(	O
or	O
all	O
biomarkers	O
)	O
can	O
also	O
be	O
exported	O
in	O
one	O
compressed	O
archive	O
:	O
.	O

Here	O
are	O
the	O
resulting	O
figures	O
for	O
Firmicutes	O
and	O
for	O
Veillonellaceae	O
(	O
extracted	O
from	O
biomarkers.zip	O
)	O
.	O



